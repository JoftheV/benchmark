<html>

<head>
    <script src="https://vega.github.io/vega/vega.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Libre+Franklin" rel="stylesheet">
</head>

<body style="cursor: default;">
<div id="time"></div>
<div id="cost"></div>
<script>
const tsv = `Warehouse	Query	Time	Cost
Snowflake	query/query1.sql	1.829	0.005494160138
Snowflake	query/query10.sql	11.945	0.03588176208
Snowflake	query/query11.sql	28.947	0.08695432122
Snowflake	query/query12.sql	1.804	0.005419062269
Snowflake	query/query13.sql	37.404	0.1123584285
Snowflake	query/query14.sql	33.454	0.1004929652
Snowflake	query/query15.sql	1.3	0.003905089218
Snowflake	query/query16.sql	2.608	0.007834209754
Snowflake	query/query17.sql	9.461	0.02842003776
Snowflake	query/query18.sql	3.985	0.01197060041
Snowflake	query/query19.sql	5.368	0.01612501456
Snowflake	query/query2.sql	11.429	0.03433174206
Snowflake	query/query20.sql	0.661	0.001985587672
Snowflake	query/query21.sql	1.527	0.004586977874
Snowflake	query/query22.sql	11.153	0.03350266157
Snowflake	query/query23.sql	84.674	0.2543534803
Snowflake	query/query24.sql	519.737	1.561245658
Snowflake	query/query25.sql	6.136	0.01843202111
Snowflake	query/query26.sql	1.993	0.005986802163
Snowflake	query/query27.sql	9.448	0.02838098687
Snowflake	query/query28.sql	24.124	0.07246644023
Snowflake	query/query29.sql	6.875	0.02065191413
Snowflake	query/query3.sql	2.58	0.00775010014
Snowflake	query/query30.sql	1.394	0.004187457208
Snowflake	query/query31.sql	7.002	0.02103341131
Snowflake	query/query32.sql	2.742	0.008236734335
Snowflake	query/query33.sql	5.774	0.01734460396
Snowflake	query/query34.sql	3.292	0.009888887466
Snowflake	query/query35.sql	5.416	0.01626920246
Snowflake	query/query36.sql	5.968	0.01792736342
Snowflake	query/query37.sql	1.885	0.005662379366
Snowflake	query/query38.sql	8.863	0.02662369672
Snowflake	query/query39.sql	3.631	0.01090721458
Snowflake	query/query4.sql	31.99	0.09609523391
Snowflake	query/query40.sql	0.961	0.002886762106
Snowflake	query/query41.sql	0.351	0.001054374089
Snowflake	query/query42.sql	3.134	0.00941426893
Snowflake	query/query43.sql	4.325	0.01299193144
Snowflake	query/query44.sql	5.831	0.0175158271
Snowflake	query/query45.sql	3.162	0.009498378544
Snowflake	query/query46.sql	6.686	0.02008417424
Snowflake	query/query47.sql	15.478	0.04649459301
Snowflake	query/query48.sql	7.562	0.02271560359
Snowflake	query/query49.sql	14.912	0.04479437724
Snowflake	query/query5.sql	7.083	0.02127672841
Snowflake	query/query50.sql	7.232	0.02172431171
Snowflake	query/query51.sql	26.026	0.07817988614
Snowflake	query/query52.sql	3.136	0.00942027676
Snowflake	query/query53.sql	3.708	0.01113851602
Snowflake	query/query54.sql	3.672	0.01103037508
Snowflake	query/query55.sql	3.007	0.009032771753
Snowflake	query/query56.sql	6.235	0.01872940867
Snowflake	query/query57.sql	5.737	0.01723345911
Snowflake	query/query58.sql	3.63	0.01090421066
Snowflake	query/query59.sql	16.39	0.04923416329
Snowflake	query/query6.sql	4.553	0.01367682401
Snowflake	query/query60.sql	5.007	0.01504060132
Snowflake	query/query61.sql	1.26	0.003784932627
Snowflake	query/query62.sql	2.65	0.007960374175
Snowflake	query/query63.sql	3.683	0.01106341815
Snowflake	query/query64.sql	23.217	0.06974188952
Snowflake	query/query65.sql	14.862	0.04464418151
Snowflake	query/query66.sql	4.861	0.01460202976
Snowflake	query/query67.sql	57.429	0.1725118221
Snowflake	query/query68.sql	10.765	0.03233714264
Snowflake	query/query69.sql	0.821	0.002466214037
Snowflake	query/query7.sql	7.321	0.02199166013
Snowflake	query/query70.sql	8.649	0.02598085896
Snowflake	query/query71.sql	7.029	0.02111451701
Snowflake	query/query72.sql	14.444	0.04338854513
Snowflake	query/query73.sql	2.758	0.008284796972
Snowflake	query/query74.sql	18.717	0.05622427299
Snowflake	query/query75.sql	17.019	0.05112362569
Snowflake	query/query76.sql	14.135	0.04246033546
Snowflake	query/query77.sql	6.083	0.01827281363
Snowflake	query/query78.sql	69.375	0.2083965881
Snowflake	query/query79.sql	6.711	0.02015927211
Snowflake	query/query8.sql	6.702	0.02013223688
Snowflake	query/query80.sql	16.221	0.0487265017
Snowflake	query/query81.sql	1.845	0.005542222775
Snowflake	query/query82.sql	1.678	0.005040569006
Snowflake	query/query83.sql	1.208	0.003628729058
Snowflake	query/query84.sql	1.1	0.003304306261
Snowflake	query/query85.sql	4.886	0.01467712763
Snowflake	query/query86.sql	2.058	0.006182056623
Snowflake	query/query87.sql	11.478	0.03447893388
Snowflake	query/query88.sql	13.736	0.04126177346
Snowflake	query/query89.sql	5.196	0.01560834121
Snowflake	query/query9.sql	29.362	0.08820094586
Snowflake	query/query90.sql	1.943	0.005836606423
Snowflake	query/query91.sql	1.098	0.003298298432
Snowflake	query/query92.sql	1.822	0.005473132735
Snowflake	query/query93.sql	6.122	0.0183899663
Snowflake	query/query94.sql	3.259	0.009789758278
Snowflake	query/query95.sql	22.204	0.06669892384
Snowflake	query/query96.sql	1.8	0.005407046609
Snowflake	query/query97.sql	13.686	0.04111157772
Snowflake	query/query98.sql	5.447	0.01636232382
Snowflake	query/query99.sql	3.756	0.01128270392
Redshift	query/query10.sql	6.112	0.01835992715
Redshift	query/query11.sql	72.375	0.2174083324
Redshift	query/query12.sql	0.951	0.002856722959
Redshift	query/query13.sql	23.617	0.07094345543
Redshift	query/query14.sql	5.358	0.01609497541
Redshift	query/query15.sql	6.349	0.01907185496
Redshift	query/query16.sql	19.685	0.0591320625
Redshift	query/query17.sql	5.387	0.01618208894
Redshift	query/query18.sql	5.132	0.01541609067
Redshift	query/query19.sql	7.154	0.02149000636
Redshift	query/query1.sql	0.332	0.000997299708
Redshift	query/query20.sql	1.031	0.003097036141
Redshift	query/query21.sql	2.718	0.00816464038
Redshift	query/query22.sql	6.044	0.01815566095
Redshift	query/query23.sql	8.894	0.02671681808
Redshift	query/query24.sql	56.587	0.1699825258
Redshift	query/query25.sql	6.278	0.01885857701
Redshift	query/query26.sql	2.959	0.008888583843
Redshift	query/query27.sql	4.704	0.01413041514
Redshift	query/query28.sql	8.932	0.02683096684
Redshift	query/query29.sql	5.223	0.01568944691
Redshift	query/query2.sql	0.301	0.0009041783497
Redshift	query/query30.sql	1.433	0.004304609884
Redshift	query/query31.sql	13.314	0.03999412142
Redshift	query/query32.sql	2.24	0.006728769114
Redshift	query/query33.sql	5.941	0.01784625773
Redshift	query/query34.sql	2.737	0.008221714761
Redshift	query/query35.sql	11.277	0.03387514701
Redshift	query/query36.sql	3.767	0.01131574699
Redshift	query/query37.sql	2.451	0.007362595133
Redshift	query/query38.sql	13.141	0.03947444416
Redshift	query/query39.sql	9.039	0.02715238572
Redshift	query/query3.sql	2.476	0.007437693003
Redshift	query/query40.sql	14.139	0.04247235112
Redshift	query/query41.sql	0.325	0.0009762723045
Redshift	query/query42.sql	2.019	0.006064903947
Redshift	query/query43.sql	3.221	0.009675609516
Redshift	query/query44.sql	4.194	0.0125984186
Redshift	query/query45.sql	5.312	0.01595679533
Redshift	query/query46.sql	5.26	0.01580059176
Redshift	query/query47.sql	8.984	0.02698717041
Redshift	query/query48.sql	8.65	0.02598386287
Redshift	query/query49.sql	5.76	0.01730254915
Redshift	query/query4.sql	92.835	0.2788684289
Redshift	query/query50.sql	7.63	0.02291986979
Redshift	query/query51.sql	19.468	0.058480213
Redshift	query/query52.sql	2.133	0.006407350232
Redshift	query/query53.sql	2.636	0.007918319368
Redshift	query/query54.sql	5.189	0.01558731381
Redshift	query/query55.sql	1.977	0.005938739526
Redshift	query/query56.sql	5.918	0.01777716769
Redshift	query/query57.sql	7.948	0.0238751147
Redshift	query/query58.sql	3.713	0.01115353559
Redshift	query/query59.sql	0.904	0.002715538964
Redshift	query/query5.sql	35.746	0.1073779378
Redshift	query/query60.sql	7.663	0.02301899898
Redshift	query/query61.sql	0.753	0.002261947832
Redshift	query/query62.sql	4.552	0.01367382009
Redshift	query/query63.sql	2.823	0.008480051432
Redshift	query/query64.sql	32.324	0.09709854145
Redshift	query/query65.sql	9.202	0.02764202383
Redshift	query/query66.sql	18.5	0.05557242349
Redshift	query/query67.sql	77.858	0.2338787972
Redshift	query/query68.sql	16.541	0.04968775443
Redshift	query/query69.sql	15.132	0.0454552385
Redshift	query/query6.sql	16.208	0.0486874508
Redshift	query/query70.sql	12.405	0.03726356288
Redshift	query/query71.sql	13.437	0.04036360294
Redshift	query/query72.sql	37.307	0.1120670488
Redshift	query/query73.sql	5.111	0.01535300846
Redshift	query/query74.sql	209.108	0.6281426124
Redshift	query/query75.sql	57.148	0.171667722
Redshift	query/query76.sql	18.504	0.05558443914
Redshift	query/query77.sql	21.743	0.06531411913
Redshift	query/query78.sql	179.437	0.5390134569
Redshift	query/query79.sql	12.722	0.03821580387
Redshift	query/query7.sql	6.904	0.02073902766
Redshift	query/query80.sql	111.5	0.3349364983
Redshift	query/query81.sql	10.066	0.03023740621
Redshift	query/query82.sql	6.089	0.01829083711
Redshift	query/query83.sql	10.931	0.03283579249
Redshift	query/query84.sql	10.472	0.03145699561
Redshift	query/query85.sql	42.757	0.1284383844
Redshift	query/query86.sql	3.282	0.009858848318
Redshift	query/query87.sql	9.089	0.02730258146
Redshift	query/query88.sql	23.095	0.06937541191
Redshift	query/query89.sql	10.193	0.03061890338
Redshift	query/query8.sql	13.01	0.03908093133
Redshift	query/query90.sql	8.716	0.02618212125
Redshift	query/query91.sql	12.143	0.03647653721
Redshift	query/query92.sql	5.885	0.0176780385
Redshift	query/query93.sql	9.799	0.02943536096
Redshift	query/query94.sql	16.599	0.04986198148
Redshift	query/query95.sql	36.41	0.1093725372
Redshift	query/query96.sql	3.022	0.009077830474
Redshift	query/query97.sql	19.029	0.05716149441
Redshift	query/query98.sql	4.837	0.01452993581
Redshift	query/query99.sql	4.923	0.01478827248
Redshift	query/query9.sql	28.427	0.08539228554
BigQuery	query/query1.sql	8.14	0.004286766052
BigQuery	query/query10.sql	5.572	0.03658771515
BigQuery	query/query11.sql	81.447	0.05128383636
BigQuery	query/query12.sql	2.958	0.008010864258
BigQuery	query/query13.sql	11.491	0.1003837585
BigQuery	query/query14.sql	9.047	0.07188796997
BigQuery	query/query15.sql	5.397	0.01587867737
BigQuery	query/query16.sql	5.483	0.03712654114
BigQuery	query/query17.sql	10.809	0.08710861206
BigQuery	query/query18.sql	6.767	0.04781246185
BigQuery	query/query19.sql	4.608	0.05078315735
BigQuery	query/query2.sql	5.32	0.01567363739
BigQuery	query/query20.sql	3.134	0.01581668854
BigQuery	query/query21.sql	4.644	0.05742549896
BigQuery	query/query22.sql	6.775	0.05745410919
BigQuery	query/query23.sql	21.764	0.08987426758
BigQuery	query/query24.sql	9.127	0.05353450775
BigQuery	query/query25.sql	11.336	0.08713722229
BigQuery	query/query26.sql	4.173	0.04198074341
BigQuery	query/query27.sql	3.212	0.0807762146
BigQuery	query/query28.sql	3.079	0.04002571106
BigQuery	query/query29.sql	13.306	0.08711338043
BigQuery	query/query3.sql	2.529	0.03053665161
BigQuery	query/query30.sql	366.784	0.002250671387
BigQuery	query/query31.sql	4.961	0.03798961639
BigQuery	query/query32.sql	2.865	0.0156879425
BigQuery	query/query33.sql	2.873	0.0719499588
BigQuery	query/query34.sql	2.665	0.05080223083
BigQuery	query/query35.sql	16.493	0.03628730774
BigQuery	query/query36.sql	4.035	0.05053043365
BigQuery	query/query37.sql	3.061	0.04823684692
BigQuery	query/query38.sql	13.453	0.03590106964
BigQuery	query/query39.sql	9.358	0.0574016571
BigQuery	query/query4.sql	43.454	0.1074361801
BigQuery	query/query40.sql	5.655	0.02771854401
BigQuery	query/query41.sql	1.722	0.00007152557373
BigQuery	query/query42.sql	2.424	0.03052711487
BigQuery	query/query43.sql	2.665	0.03002643585
BigQuery	query/query44.sql	25.943	0.04052639008
BigQuery	query/query45.sql	7.079	0.01074314117
BigQuery	query/query46.sql	5.366	0.08090019226
BigQuery	query/query47.sql	5.704	0.04053592682
BigQuery	query/query48.sql	6.461	0.07036685944
BigQuery	query/query49.sql	4.791	0.1152706146
BigQuery	query/query5.sql	5.459	0.08400917053
BigQuery	query/query50.sql	6.598	0.05509853363
BigQuery	query/query51.sql	12.989	0.03835678101
BigQuery	query/query52.sql	2.162	0.03053665161
BigQuery	query/query53.sql	2.95	0.04055500031
BigQuery	query/query54.sql	7.22	0.0538444519
BigQuery	query/query55.sql	2.329	0.03053665161
BigQuery	query/query56.sql	3.551	0.07195949554
BigQuery	query/query57.sql	6.149	0.02091884613
BigQuery	query/query58.sql	3.676	0.05404472351
BigQuery	query/query59.sql	5.328	0.03003120422
BigQuery	query/query6.sql	45.819	0.0307226181
BigQuery	query/query60.sql	4.438	0.07195949554
BigQuery	query/query61.sql	5.184	0.06074905396
BigQuery	query/query62.sql	2.351	0.01310348511
BigQuery	query/query63.sql	2.747	0.04055500031
BigQuery	query/query64.sql	31.375	0.1421499252
BigQuery	query/query65.sql	8.905	0.04063606262
BigQuery	query/query66.sql	3.083	0.05483627319
BigQuery	query/query67.sql	17.084	0.05057811737
BigQuery	query/query68.sql	6.517	0.09090900421
BigQuery	query/query69.sql	5.912	0.03632545471
BigQuery	query/query7.sql	4.666	0.0807762146
BigQuery	query/query70.sql	4.055	0.03002643585
BigQuery	query/query71.sql	3.403	0.07190704346
BigQuery	query/query72.sql	860.182	0.2575922012
BigQuery	query/query73.sql	3.855	0.05080223083
BigQuery	query/query74.sql	19.971	0.03826141357
BigQuery	query/query75.sql	6.434	0.09745121002
BigQuery	query/query76.sql	4.063	0.07187366486
BigQuery	query/query77.sql	5.006	0.07849216461
BigQuery	query/query78.sql	37.11	0.129532814
BigQuery	query/query79.sql	4.828	0.080742836
BigQuery	query/query8.sql	5.046	0.03019332886
BigQuery	query/query80.sql	9.01	0.1331233978
BigQuery	query/query81.sql	15.976	0.003066062927
BigQuery	query/query82.sql	5.065	0.05347728729
BigQuery	query/query83.sql	5.952	0.00542640686
BigQuery	query/query84.sql	3.942	0.00168800354
BigQuery	query/query85.sql	10.847	0.02068519592
BigQuery	query/query86.sql	2.853	0.007886886597
BigQuery	query/query87.sql	13.984	0.03590106964
BigQuery	query/query88.sql	5.122	0.03003120422
BigQuery	query/query89.sql	3.807	0.04054546356
BigQuery	query/query9.sql	4.087	0.03002166748
BigQuery	query/query90.sql	3.072	0.00786781311
BigQuery	query/query91.sql	4.23	0.002632141113
BigQuery	query/query92.sql	3.623	0.007882118225
BigQuery	query/query93.sql	7.271	0.05509376526
BigQuery	query/query94.sql	7.756	0.018658638
BigQuery	query/query95.sql	17.539	0.018658638
BigQuery	query/query96.sql	2.694	0.03003120422
BigQuery	query/query97.sql	7.356	0.04616260529
BigQuery	query/query98.sql	4.561	0.03064155579
BigQuery	query/query99.sql	3.942	0.02606868744`;

const config = {
    "axis": {
        "labelFont": "Libre Franklin",
        "labelFontSize": 12,
        "labelColor": "rgb(150, 150, 150)",
        "gridWidth": 1.5,
        "gridColor": "rgb(223, 223, 223)",
        "tickColor": "rgb(223, 223, 223)",
        "tickSize": 10
    },
    "text": {
        "font": "Libre Franklin"
    },
    "rect": {
        "fill": "#1AC9FF"
    }
};

const width = 600, height = 600;
const background = "rgb(240, 240, 240)";

const time = {
    "$schema": "https://vega.github.io/schema/vega/v3.0.json",
    "width": width,
    "height": height,
    "background": background,
    "padding": 5,
    "data": [
        {
            "name": "raw",
            "format": {"type": "tsv"},
            "values": tsv,
        },
        {
            "name": "table",
            "source": "raw",
            "transform": [
                {
                    "type": "formula",
                    "expr": "log(datum.Time) / LN2",
                    "as": "LogTime"
                },
                {
                    "type": "bin",
                    "field": "LogTime",
                    "step": 0.5,
                    "extent": [-10, 10],
                    "as": ["LogTimeBinLeft", "LogTimeBinRight"]
                },
                {
                    "type": "aggregate",
                    "groupby": ["Warehouse", "LogTimeBinLeft", "LogTimeBinRight"],
                    "as": ["Count"]
                },
                {
                    "type": "formula",
                    "expr": "pow(2, datum.LogTimeBinLeft)",
                    "as": "TimeBinLeft"
                },
                {
                    "type": "formula",
                    "expr": "pow(2, datum.LogTimeBinRight)",
                    "as": "TimeBinRight"
                }
            ]
        },
        {
            "name": "medians",
            "source": "raw",
            "transform": [
                {
                    "type": "aggregate",
                    "groupby": ["Warehouse"],
                    "fields": ["Time"],
                    "ops": ["median"],
                    "as": ["MedianTime"]
                }
            ]
        }
    ],
    "scales": [
        {
            "name": "xscale",
            "type": "log",
            "domain": [0.1, 1024],
            "range": "width"
        },
        {
            "name": "ypane",
            "type": "band",
            "domain": {
                "data": "table",
                "field": "Warehouse"
            },
            "range": "height",
            "padding": 0.3
        },
        {
            "name": "yscale",
            "domain": {
                "data": "table",
                "field": "Count"
            },
            "range": [{"signal": "bandwidth('ypane')"}, 0],
            "round": true
        }
    ],
    "axes": [
        {
            "orient": "right",
            "scale": "ypane",
            "domain": false,
            "ticks": false,
            "offset": {"value": 10},
            "encode": {
                "labels": {
                    "enter": {
                        "text": {"signal": "datum.value"},
                        "fontSize": {"value": 13},
                        "fontWeight": {"value": 100}
                    }
                }
            }
        }
    ],
    "marks": [
        {
            "type": "group",
            "from": {
                "facet": {
                    "data": "table",
                    "name": "facet",
                    "groupby": "Warehouse"
                }
            },
            "encode": {
                "enter": {
                    "y": {
                        "scale": "ypane", 
                        "field": "Warehouse"
                    },
                    "width": {"signal": "width"},
                    "height": {"signal": "bandwidth('ypane')"}
                }
            },
            "axes": [
                {
                    "orient": "left",
                    "scale": "yscale",
                    "tickCount": 5,
                    "grid": true,
                    "domain": false
                },
                {
                    "orient": "bottom",
                    "scale": "xscale",
                    "values": [0.25,0.5,1,2,4,8,16,32,64,128,256,512],
                    "grid": true
                }
            ],
            "marks": [
                {
                    "type": "rect",
                    "from": {
                        "data": "facet"
                    },
                    "encode": {
                        "enter": {
                            "x": {
                                "scale": "xscale",
                                "field": "TimeBinLeft",
                                "offset": "1"
                            },
                            "x2": {
                                "scale": "xscale",
                                "field": "TimeBinRight",
                                "offset": "-1"
                            },
                            "y": {
                                "scale": "yscale",
                                "field": "Count"
                            },
                            "y2": {
                                "scale": "yscale",
                                "value": 0
                            }
                        }
                    }
                }
            ]
        },
        {
            "type": "group",
            "from": {
                "facet": {
                    "data": "medians",
                    "name": "facet",
                    "groupby": "Warehouse"
                }
            },
            "encode": {
                "enter": {
                    "y": {
                        "scale": "ypane", 
                        "field": "Warehouse"
                    },
                    "width": {"signal": "width"},
                    "height": {"signal": "bandwidth('ypane')"}
                }
            },
            "marks": [
                {
                    "type": "text",
                    "from": {"data": "facet"},
                    "encode": {
                        "enter": {
                            "text": {"signal": "'Median = ' + round(datum.MedianTime * 10) / 10"},
                            "dx": {"value": 5},
                            "x": {
                                "scale": "xscale",
                                "field": "MedianTime"
                            },
                            "fill": {"value": "#2349E5"},
                        }
                    }
                },
                {
                    "type": "rule",
                    "from": {"data": "facet"},
                    "encode": {
                        "enter": {
                            "x": {
                                "scale": "xscale",
                                "field": "MedianTime"
                            },
                            "y": {"value": 0},
                            "y2": {"signal": "bandwidth('ypane')"},
                            "stroke": {"value": "#2349E5"},
                            "strokeWidth": {"value": 2}
                        }
                    }
                }
            ]
        },
        {
            "type": "text",
            "encode": {
                "enter": {
                    "x": {"signal": "width / 2"},
                    "y": {"signal": "height"},
                    "text": {"value": "Execution time, log scale [s]"},
                    "baseline": {"value": "top"},
                    "align": {"value": "center"},
                    "fontSize": {"value": 13},
                    "fontWeight": {"value": 100}
                }
            }
        }
    ],
    "config": config
};

new vega.View(vega.parse(time), {
    loader: vega.loader({ baseURL: 'https://vega.github.io/vega/' }),
    logLevel: vega.Warn,
    renderer: 'canvas'
}).initialize('#time').hover().run();

const cost = {
    "$schema": "https://vega.github.io/schema/vega/v3.0.json",
    "width": width,
    "height": height,
    "background": background,
    "padding": 5,
    "data": [
        {
            "name": "raw",
            "format": {"type": "tsv"},
            "values": tsv,
        },
        {
            "name": "table",
            "source": "raw",
            "transform": [
                {
                    "type": "formula",
                    "expr": "log(datum.Cost) / LN2",
                    "as": "LogCost"
                },
                {
                    "type": "bin",
                    "field": "LogCost",
                    "step": 0.5,
                    "extent": [-10, 10],
                    "as": ["LogCostBinLeft", "LogCostBinRight"]
                },
                {
                    "type": "aggregate",
                    "groupby": ["Warehouse", "LogCostBinLeft", "LogCostBinRight"],
                    "as": ["Count"]
                },
                {
                    "type": "formula",
                    "expr": "pow(2, datum.LogCostBinLeft)",
                    "as": "TimeBinLeft"
                },
                {
                    "type": "formula",
                    "expr": "pow(2, datum.LogCostBinRight)",
                    "as": "TimeBinRight"
                }
            ]
        },
        {
            "name": "medians",
            "source": "raw",
            "transform": [
                {
                    "type": "aggregate",
                    "groupby": ["Warehouse"],
                    "fields": ["Cost"],
                    "ops": ["median"],
                    "as": ["MedianCost"]
                }
            ]
        }
    ],
    "scales": [
        {
            "name": "xscale",
            "type": "log",
            "domain": [0.001, 2],
            "range": "width"
        },
        {
            "name": "ypane",
            "type": "band",
            "domain": {
                "data": "table",
                "field": "Warehouse"
            },
            "range": "height",
            "padding": 0.3
        },
        {
            "name": "yscale",
            "domain": {
                "data": "table",
                "field": "Count"
            },
            "range": [{"signal": "bandwidth('ypane')"}, 0],
            "round": true
        }
    ],
    "axes": [
        {
            "orient": "right",
            "scale": "ypane",
            "domain": false,
            "ticks": false,
            "offset": {"value": 10},
            "encode": {
                "labels": {
                    "enter": {
                        "text": {"signal": "datum.value"},
                        "fontSize": {"value": 13},
                        "fontWeight": {"value": 100}
                    }
                }
            }
        }
    ],
    "marks": [
        {
            "type": "group",
            "from": {
                "facet": {
                    "data": "table",
                    "name": "facet",
                    "groupby": "Warehouse"
                }
            },
            "encode": {
                "enter": {
                    "y": {
                        "scale": "ypane", 
                        "field": "Warehouse"
                    },
                    "width": {"signal": "width"},
                    "height": {"signal": "bandwidth('ypane')"}
                }
            },
            "axes": [
                {
                    "orient": "left",
                    "scale": "yscale",
                    "tickCount": 5,
                    "grid": true,
                    "domain": false
                },
                {
                    "orient": "bottom",
                    "scale": "xscale",
                    "values": [0.03125/2/2/2, 0.03125/2/2, 0.03125/2, 0.03125, 0.0625, 0.125, 0.25, 0.5, 1],
                    "grid": true
                }
            ],
            "marks": [
                {
                    "type": "rect",
                    "from": {
                        "data": "facet"
                    },
                    "encode": {
                        "enter": {
                            "x": {
                                "scale": "xscale",
                                "field": "TimeBinLeft",
                                "offset": "1"
                            },
                            "x2": {
                                "scale": "xscale",
                                "field": "TimeBinRight",
                                "offset": "-1"
                            },
                            "y": {
                                "scale": "yscale",
                                "field": "Count"
                            },
                            "y2": {
                                "scale": "yscale",
                                "value": 0
                            }
                        }
                    }
                }
            ]
        },
        {
            "type": "group",
            "from": {
                "facet": {
                    "data": "medians",
                    "name": "facet",
                    "groupby": "Warehouse"
                }
            },
            "encode": {
                "enter": {
                    "y": {
                        "scale": "ypane", 
                        "field": "Warehouse"
                    },
                    "width": {"signal": "width"},
                    "height": {"signal": "bandwidth('ypane')"}
                }
            },
            "marks": [
                {
                    "type": "text",
                    "from": {"data": "facet"},
                    "encode": {
                        "enter": {
                            "text": {"signal": "'Median = $' + round(datum.MedianCost * 1000) / 1000"},
                            "dx": {"value": 5},
                            "x": {
                                "scale": "xscale",
                                "field": "MedianCost"
                            },
                            "fill": {"value": "#2349E5"},
                        }
                    }
                },
                {
                    "type": "rule",
                    "from": {"data": "facet"},
                    "encode": {
                        "enter": {
                            "x": {
                                "scale": "xscale",
                                "field": "MedianCost"
                            },
                            "y": {"value": 0},
                            "y2": {"signal": "bandwidth('ypane')"},
                            "stroke": {"value": "#2349E5"},
                            "strokeWidth": {"value": 2}
                        }
                    }
                }
            ]
        },
        {
            "type": "text",
            "encode": {
                "enter": {
                    "x": {"signal": "width / 2"},
                    "y": {"signal": "height"},
                    "text": {"value": "Cost to run query, log scale [$]"},
                    "baseline": {"value": "top"},
                    "align": {"value": "center"},
                    "fontSize": {"value": 13},
                    "fontWeight": {"value": 100}
                }
            }
        }
    ],
    "config": config
};

new vega.View(vega.parse(cost), {
    loader: vega.loader({ baseURL: 'https://vega.github.io/vega/' }),
    logLevel: vega.Warn,
    renderer: 'canvas'
}).initialize('#cost').hover().run();

</script>
</body>

</html>